---
title: "DiNeR Tutorial"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
source("./DifferentialNetworkVis.R")
```

## Create dummy data
TODO: maybe use some random Giotto output later

```{r include=TRUE}
test_df_1 <- data.frame(N1 = c("A","B","C"), N2 = c("A","A","F"), Weight=c(2.78, -5.12, -1.28), Type=c("Enriched", "Depleted", "Depleted"), stringsAsFactors=FALSE)
test_df_2 <- data.frame(N1 = c("E","A","A","H","C","F"), N2 = c("D","B","F","G","A","F"), Weight=c(2.78, -5.12, 1.28, 6.7, 1.9, -8.3), Type=c("Enriched", "Depleted", "Enriched", "Enriched", "Enriched", "Depleted"), stringsAsFactors=FALSE)
test_df_3 <- data.frame(N1 = c("A","B","F","C"), N2 = c("G","A","B","D"), Weight=c(1,2,3,4), Type=c("Enriched", "Enriched", "Enriched", "Enriched"), stringsAsFactors=FALSE)
```

## Creating object

```{r }
edge_lists <- lapply(list(test_df_1, test_df_2, test_df_3), function(x){
  return(x[,c("N1", "N2")])
})

diff_network_object <- create_diff_network_object(edge_lists)

print(diff_network_object)

```

Let's try adding some data for individuals


```{r}
individual_info <- data.frame(Index=c(1,2,3), PatientID=c("Patient 131", "Patient 32", "Patient 203"), Diagnosis=c("Control", "Disease", "Disease"))
diff_network_object = add_individual_features(diff_network_object, individual_info)
```


```{r}
diff_network_object = add_individual_features(diff_network_object, data.frame(Age=c(47, 53, 28)))
```


```{r}
diff_network_object
```

now let's add some edge features

```{r}
edge_feature_list = edge_lists <- lapply(list(test_df_1, test_df_2, test_df_3), function(x){
  return(x[,c("Weight", "Type")])
})

diff_network_object = add_edge_features(diff_network_object, edge_feature_list)

```


```{r}
diff_network_object
```

Using `plot individual` with no other inputs. The color scheme will be randomly decided.

```{r}
plot_individual(diff_network_object)
```

We can, however, add our own color scheme


```{r}
#TODO: need to add input for node colors? 
colors <- data.frame(high=c("#191970", "#ADD8E6", "#7FFFD4"), low=c("#9A2A2A", "#FAA0A0", "#2AAA8A"))
plot_individual(diff_network_object, colors=colors)
```


We can also use `lapply` to run this on all of our data
```{r}
# TODO: the colors for edges aren't the same for all patients... need to use rownames 
lapply(1:3, function(i){
  plot_individual(diff_network_object, idx=i, colors=colors)
})
```

## More comparisons across individuals

Consensus edge plots allow us to see the occurrence of edges
```{r}
# TODO: make edge legend gradient or remove 1.5, 2.5 etc.
# TODO: need to change legend labels for all (use labels)
consensus_edge(diff_network_object)
```

## Pie charts

Pie charts for one group
```{r}
make_piecharts(diff_network_object, edge_feature="Type")
```

```{r}
#TODO: change color schemes

#TODO: change label order
```

We can also create an additional visualization for multiple groups
```{r}
make_piecharts_by_group(diff_network_object, edge_feature="Type", group_label="Diagnosis")
```

## Making edits to graphs
```{r}
#TODO: how can we change some of the elements, i.e. legend fonts, sizes, etc?
```


## My own to-do list
```{r}
#TODO: include a way to label all "empty" edges. i.e. if it isn't enriched or depleted, it's neither

```


